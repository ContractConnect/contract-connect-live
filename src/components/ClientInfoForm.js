[FULL CODE INSERTED HERE MANUALLY IN NEXT STEP]